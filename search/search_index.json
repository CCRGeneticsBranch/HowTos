{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Intro","text":"<p>This page is built by following the CCBR HowTos tutorial available here.</p> <p>You will find tutorials, how-tos and documentation for khanlab relevant tasks.</p>"},{"location":"Cavatica/Overview/","title":"Accessing the data","text":"<p>To access Cavatica, log in using your NIH account and PIV card. This will display the projects you have access to on Cavatica.</p> <p>The easiest way to download files from Cavatica is by following these steps:</p> <ol> <li>Log in to Cavatica using your NIH account and PIV card.</li> <li>Navigate to the project containing the files you want to download.</li> <li>Select the checkbox next to each file you want to download.</li> <li>Click the download button located at the top of the page.</li> </ol> <p></p> <p>This method is particularly useful when dealing with a small number of files or files of small sizes.</p> <p>For handling large numbers of files and files with substantial sizes such as FASTQs, VCFs, or BAM files, it's recommended to utilize the Seven Bridges python API.</p> <p>You can find instructions on how to download and use the API in the official documentation: Seven Bridges python API</p> <p>Using the API offers more efficient and flexible options for managing and downloading files from Cavatica, particularly when dealing with large datasets in nested folders.</p> <p>To access the data using API,</p> <ol> <li>Obtain the authentication token from the <code>Developer</code> tab at the top of the Cavatica page.</li> <li>Identify the API end point for Cavatica, this information can be found here.For Cavatica env API end point is https://cavatica-api.sbgenomics.com/v2</li> <li>Install the seven bridges python package in your conda env on biowulf or local machine.</li> </ol> <pre><code>#!/usr/bin/env python\nfrom sevenbridges import Api\nfrom sevenbridges.http.error_handlers import rate_limit_sleeper, maintenance_sleeper\nimport requests\nimport os\nimport sys\n\n# This step lists out all the projects you have access to.\napi = Api(url='https://cavatica-api.sbgenomics.com/v2', token='input-your-token-here',error_handlers=[rate_limit_sleeper, maintenance_sleeper])\nfor project in api.projects.query().all():\n    print (\"ID: \", project.id, \" Name:\", project.name)\n\n#To view subfolders of a specific project\n#project name should be provided in this format - user/projectname example: gangalapudiv2/test\nroot_folder = api.files.query(project='Enter-your-project-name-here') \nfor folder in root_folder:\n    print(folder.id, folder.name) # This will print out folder id and folder name for all the subfolders in this project\n\n#To download meta data information for all the files within a folder/subfolder.\ntotal_file_size = 0\nnum_files = 0\n#using .all() to get list of all files in the subfolders.\nfolder = api.files.get(id='Provide-folder-id-here')\nfolder_subfolders = folder.list_files().all()\nfor subfolder in folder_subfolders:\n        if subfolder.type == 'folder':  # Check if it's a folder\n            print(\"Subfolder: \", subfolder.name)\n            sb = api.files.get(id=subfolder.id)\n            files = sb.list_files().all()\n            for file in files:\n                num_files += 1\n                print(\"File ID: \", file.id)\n                print(\"File Name: \", file.name)\n                print(\"File Metadata: \", file.metadata)\n        else:\n            print(f\"Skipping {subfolder.name} because it's not a folder.\")\n</code></pre>"}]}